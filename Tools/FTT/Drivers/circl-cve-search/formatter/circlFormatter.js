const fs = require('fs');
const path = require('path');

var jsonData = fs.readFileSync('../api-retrieval/output_1.json', "utf8");

var data = JSON.parse(jsonData);

var output = [];

for (vuln of data.vulnerabilities) {
  var entry = {};
  entry.cve = vuln.id;

  entry.cwe = vuln.cwe;

  entry.summary = vuln.summary;

  entry.references = vuln.references;

  entry.versions = {};
  entry.versions.vulnerable = [];
  for (spec of vuln.vulnerable_configuration) {
    entry.versions.vulnerable.push({version: "", cpe23: spec});
  }

  entry.versions.safe = [];

  output.push(entry);
}


fs.appendFile('output_0.json', JSON.stringify({entries: output}), (err) => { if (err) throw err; });
